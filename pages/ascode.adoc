= Le As Code

[NOTE.speaker]
====
* Comment organiser tout ça ?
* Voyons un peu ce qu'il se fait
====

== Approches orienté outil

[NOTE.speaker]
====
* Un peu le classique du DevOps
* Chaque outil porte sa conf (infra, provisionning et configuration)
====

== !

[source, shellscript]
----
vault
|-- docs/
|-- infra/
|   |-- network/
|   |-- vm/
|   |-- ...
|-- provision/
|   |-- compose.yaml
|   |-- config/
|   |-- certs/
|-- config/
|   |-- general/
|   |-- projects/
| .gitlab-ci.yml
----

[NOTE.speaker]
====
* Chaque outil porte son infra et son delivery
* En respectant les règles établies
* Autonomie de l'équipe
====

== Pro

[%step]
* Cohérence intra outillage
* Indépendance des outils
* Propre à gérer
** un outil -> un dépôt

== Cons

[%step]
* Partage de code
* Nécessite des compétences sur toutes les couches
* Cohérence générale entre les outils
* Mais surtout :
** Dépendance entre outils

== !

image:new-user-impact.png[1, 80%]

[NOTE.speaker]
====
Par exemple :

* A chaque utilisateur 4 dépôts minimum à toucher
** Gitlab/Sonar/Vault/Artifactory

Ou bien :
====

== !

image:forge-all-hidden-tools-12.png[1, 80%]

[NOTE.speaker]
====
Mise à jour des certificats ....
On modifie tout et on redéclenche tout
====

== L'enfer !

== Orienté Landing zone

* L'infra + le monitoring + la gestion des accès niveau environnement
* Souvent pour une équipe dédiée
* Pour de l'accueil d'autres projets d'autres équipes

Pro :
* Cohérence de l'infra
* Sécurité ++

Cons :
* Ben, nous on déploie toujours les mêmes outils
* Tous nos outils fonctionnent ensemble

== Chez nous, tout touche à tout

* Ex.: Si l'auth gitlab change
** Regeneration des services accounts
** Modification artif
** Modification de sonar

* Ex.: Déploiment d'un nouvel outil
** Ouverture de flux => Infra
** Branchement avec les outils qui s'en serve => Provisionning
** Configuration des accès pour les projets => Projet

== Tout dans le même dépôt ?

* A chaque nouvel utilisateur, on rejoue tout ?
** Même avec des astuces, complexité accrue
** Branching Git horrible

* Monté de version d'un outil ?
** Idem, on risque en plus de peter un truc

* Fréquence d'exécution du script
** Trop fréquent pour un truc qui attaque toute l'infra

== Par outils ?

* Indépendance/Autonomie
* Gestion de la configuration par projet jusqu'à l'infra
** Pratique en cas de changement de version, ça permet de rester cohérent
** Facilitation de la gestion infra si besoin de nouveau flux, nouvelles ressources
* Mais
** Vu le nombre d'outils
** Code : Gardez une cohérence en terme de style, de règles d'écriture
** Cohérence générale : Y'a toujours des effets de bord, des non compatibilités, des dépendances à gérer
** Demande des compétences sur toutes les couches

== Autrement ?
